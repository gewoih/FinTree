.forecast-card {
  display: flex;
  flex-direction: column;
  gap: var(--ft-space-4);

  padding: clamp(1rem, 2vw, 1.5rem);

  background: var(--ft-surface-base);
  border: 1px solid var(--ft-border-subtle);
  border-radius: var(--ft-radius-xl);
  box-shadow: var(--ft-shadow-sm);
}

.forecast-card__head {
  display: grid;
  gap: var(--ft-space-3);
}

.forecast-card__title-row {
  display: inline-flex;
  gap: var(--ft-space-2);
  align-items: center;
}

.forecast-card__title {
  margin: 0;
  font-size: var(--ft-text-lg);
  font-weight: var(--ft-font-semibold);
  color: var(--ft-text-primary);
}

.forecast-card__hint {
  cursor: pointer;

  display: inline-flex;
  align-items: center;
  justify-content: center;

  /* Ensure minimum touch target size */
  min-width: var(--ft-control-height);
  min-height: var(--ft-control-height);
  padding: 0;

  font-size: 1rem;
  color: var(--ft-text-muted);

  background: none;
  border: none;

  transition: color var(--ft-transition-fast);
}

.forecast-card__hint:hover {
  color: var(--ft-text-secondary);
}

.forecast-card__hint:active {
  color: var(--ft-accent-primary);
}

.forecast-card__loading {
  display: grid;
  gap: var(--ft-space-3);
}

.forecast-card__loading-kpi {
  display: flex;
  flex-direction: column;
  gap: var(--ft-space-2);
}

.forecast-card__loading-secondary {
  display: flex;
  gap: var(--ft-space-4);
}

.forecast-card__message {
  display: grid;
}

.forecast-card__message-body {
  display: grid;
  gap: var(--ft-space-3);
}

.forecast-card__message-body--compact {
  gap: var(--ft-space-2);
}

.forecast-card__message-title {
  margin: 0;
  font-weight: var(--ft-font-semibold);
}

.forecast-card__message-text {
  margin: 0;
}

/* KPI Hero */
.forecast-kpi {
  display: flex;
  flex-direction: column;
  gap: var(--ft-space-3);
}

.forecast-hero {
  display: flex;
  flex-direction: column;
  gap: var(--ft-space-1);
}

.forecast-hero__label {
  font-size: var(--ft-text-sm);
  color: var(--ft-text-secondary);
}

.forecast-hero__value {
  font-size: var(--ft-text-3xl);
  font-weight: var(--ft-font-bold);
  font-variant-numeric: tabular-nums;
  color: var(--ft-chart-forecast);
}

.forecast-hero--average .forecast-hero__value {
  color: var(--ft-warning-400);
}

.forecast-hero--poor .forecast-hero__value {
  color: var(--ft-danger-400);
}

.forecast-secondary {
  display: flex;
  gap: var(--ft-space-6);
}

.forecast-stat {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.forecast-stat__label {
  font-size: var(--ft-text-xs);
  color: var(--ft-text-muted);
  text-transform: uppercase;
  letter-spacing: 0.04em;
}

.forecast-stat__value {
  font-size: var(--ft-text-base);
  font-weight: var(--ft-font-semibold);
  font-variant-numeric: tabular-nums;
}

.forecast-stat--optimistic .forecast-stat__value {
  color: var(--ft-chart-optimistic);
}

.forecast-stat--risk .forecast-stat__value {
  color: var(--ft-chart-risk);
}

/* Chart */
.forecast-card__chart {
  aspect-ratio: 16 / 9;
  width: 100%;
  max-height: 400px;
}

.forecast-card__chart-container {
  position: relative;
  width: 100%;
  height: 100%;
}

/* stylelint-disable-next-line selector-pseudo-class-no-unknown */
.forecast-card__chart-container :deep(.p-chart) {
  width: 100%;
  height: 100%;
}

/* stylelint-disable-next-line selector-pseudo-class-no-unknown */
.forecast-card__chart-container :deep(canvas) {
  height: 100%;
  max-height: 100%;
}

/* Integrated legend */
.forecast-card__legend {
  display: flex;
  flex-wrap: wrap;
  gap: var(--ft-space-3);
  padding-top: var(--ft-space-1);
}

.forecast-legend__item {
  display: inline-flex;
  gap: var(--ft-space-2);
  align-items: center;

  font-size: var(--ft-text-lg);
  color: var(--ft-text-secondary);
}

.forecast-legend__line {
  display: inline-block;
  width: 20px;
  height: 2px;
  border-radius: var(--ft-radius-full);
}

.forecast-legend__line--actual {
  background: var(--ft-chart-1);
}

.forecast-legend__line--forecast {
  height: 0;
  background: var(--ft-chart-forecast);
  border-top: 2px dashed var(--ft-chart-forecast);
}

.forecast-legend__line--optimistic {
  height: 0;
  background: var(--ft-chart-optimistic);
  border-top: 2px dashed var(--ft-chart-optimistic);
}

.forecast-legend__line--risk {
  height: 0;
  background: var(--ft-chart-risk);
  border-top: 2px dashed var(--ft-chart-risk);
}

.forecast-legend__line--baseline {
  height: 0;
  background: var(--ft-chart-baseline);
  border-top: 2px dashed var(--ft-chart-baseline);
}

@media (width <= 640px) {
  .forecast-card__chart {
    aspect-ratio: 4 / 3;
    max-height: 280px;
  }

  .forecast-legend__item {
    font-size: var(--ft-text-sm);
  }
}
